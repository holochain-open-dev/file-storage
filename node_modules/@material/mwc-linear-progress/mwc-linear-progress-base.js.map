{"version":3,"file":"mwc-linear-progress-base.js","sourceRoot":"","sources":["mwc-linear-progress-base.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2018 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {html, internalProperty, LitElement, property, PropertyValues, query, TemplateResult} from 'lit-element';\nimport {classMap} from 'lit-html/directives/class-map';\nimport {ifDefined} from 'lit-html/directives/if-defined';\nimport {styleMap} from 'lit-html/directives/style-map';\n\n/** @soyCompatible */\nexport class LinearProgressBase extends LitElement {\n  @query('.mdc-linear-progress') protected rootEl!: HTMLElement;\n\n  @property({type: Boolean, reflect: true}) indeterminate = false;\n\n  @property({type: Number}) progress = 0;\n\n  @property({type: Number}) buffer = 1;\n\n  @property({type: Boolean, reflect: true}) reverse = false;\n\n  @property({type: Boolean, reflect: true}) closed = false;\n\n  @property() ariaLabel = '';\n\n  @internalProperty() protected stylePrimaryHalf = '';\n  @internalProperty() protected stylePrimaryFull = '';\n  @internalProperty() protected styleSecondaryQuarter = '';\n  @internalProperty() protected styleSecondaryHalf = '';\n  @internalProperty() protected styleSecondaryFull = '';\n  @internalProperty() protected animationReady = true;\n  @internalProperty() protected closedAnimationOff = false;\n  protected resizeObserver: ResizeObserver|null = null;\n\n  connectedCallback() {\n    super.connectedCallback();\n    // if detached and reattached\n    if (this.rootEl) {\n      this.attachResizeObserver();\n    }\n  }\n\n  /**\n   * @soyTemplate\n   */\n  protected render(): TemplateResult {\n    /** @classMap */\n    const classes = {\n      'mdc-linear-progress--closed': this.closed,\n      'mdc-linear-progress--closed-animation-off': this.closedAnimationOff,\n      'mdc-linear-progress--indeterminate': this.indeterminate,\n      'mdc-linear-progress--reversed': this.reverse,\n      // needed for controller-less render\n      'mdc-linear-progress--animation-ready': this.animationReady\n    };\n\n    const rootStyles = {\n      '--mdc-linear-progress-primary-half': this.stylePrimaryHalf,\n      '--mdc-linear-progress-primary-half-neg':\n          this.stylePrimaryHalf !== '' ? `-${this.stylePrimaryHalf}` : '',\n      '--mdc-linear-progress-primary-full': this.stylePrimaryFull,\n      '--mdc-linear-progress-primary-full-neg':\n          this.stylePrimaryFull !== '' ? `-${this.stylePrimaryFull}` : '',\n      '--mdc-linear-progress-secondary-quarter': this.styleSecondaryQuarter,\n      '--mdc-linear-progress-secondary-quarter-neg':\n          this.styleSecondaryQuarter !== '' ? `-${this.styleSecondaryQuarter}` :\n                                              '',\n      '--mdc-linear-progress-secondary-half': this.styleSecondaryHalf,\n      '--mdc-linear-progress-secondary-half-neg':\n          this.styleSecondaryHalf !== '' ? `-${this.styleSecondaryHalf}` : '',\n      '--mdc-linear-progress-secondary-full': this.styleSecondaryFull,\n      '--mdc-linear-progress-secondary-full-neg':\n          this.styleSecondaryFull !== '' ? `-${this.styleSecondaryFull}` : '',\n    };\n\n    const bufferBarStyles = {\n      'flex-basis': this.indeterminate ? '100%' : `${this.buffer * 100}%`,\n    };\n\n    const primaryBarStyles = {\n      transform: this.indeterminate ? 'scaleX(1)' : `scaleX(${this.progress})`,\n    };\n\n    return html`\n      <div\n          role=\"progressbar\"\n          class=\"mdc-linear-progress ${classMap(classes)}\"\n          style=${styleMap(rootStyles)}\n          aria-label=${ifDefined(this.ariaLabel ? this.ariaLabel : undefined)}\n          aria-valuemin=\"0\"\n          aria-valuemax=\"1\"\n          aria-valuenow=${\n        ifDefined(this.indeterminate ? undefined : this.progress)}\n        @transitionend=${this.syncClosedState}>\n        <div class=\"mdc-linear-progress__buffer\">\n          <div\n            class=\"mdc-linear-progress__buffer-bar\"\n            style=${styleMap(bufferBarStyles)}>\n          </div>\n          <div class=\"mdc-linear-progress__buffer-dots\"></div>\n        </div>\n        <div\n            class=\"mdc-linear-progress__bar mdc-linear-progress__primary-bar\"\n            style=${styleMap(primaryBarStyles)}>\n          <span class=\"mdc-linear-progress__bar-inner\"></span>\n        </div>\n        <div class=\"mdc-linear-progress__bar mdc-linear-progress__secondary-bar\">\n          <span class=\"mdc-linear-progress__bar-inner\"></span>\n        </div>\n      </div>`;\n  }\n\n  update(changedProperties: Map<string, string>) {\n    // - When showing the indicator, enable animations immediately.\n    // - On first render, disable the animation immediately.\n    // - For normal calls to hide the component, let transitionend event trigger\n    //   disabling of animations instead (see render method), so that animation\n    //   does not jump in the middle of fade out.\n    if (changedProperties.has('closed') &&\n        (!this.closed || changedProperties.get('closed') === undefined)) {\n      this.syncClosedState();\n    }\n    super.update(changedProperties);\n  }\n\n  async firstUpdated(changed: PropertyValues) {\n    super.firstUpdated(changed);\n\n    this.attachResizeObserver();\n  }\n\n  private syncClosedState() {\n    this.closedAnimationOff = this.closed;\n  }\n\n  protected updated(changed: PropertyValues) {\n    // restart animation for timing if reverse changed and is indeterminate.\n    // don't restart here if indeterminate has changed as well because we don't\n    // want to incur an extra style recalculation\n    if (!changed.has('indeterminate') && changed.has('reverse') &&\n        this.indeterminate) {\n      this.restartAnimation();\n    }\n\n    // Recaclulate the animation css custom props and restart the calculation\n    // if this is not the first render cycle, otherwise, resize observer init\n    // will already handle this and prevent unnecessary rerender + style recalc\n    // but resize observer will not update animation vals while determinate\n    if (changed.has('indeterminate') &&\n        changed.get('indeterminate') !== undefined && this.indeterminate &&\n        window.ResizeObserver) {\n      this.calculateAndSetAnimationDimensions(this.rootEl.offsetWidth);\n    }\n    super.updated(changed);\n  }\n\n  disconnectedCallback() {\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n      this.resizeObserver = null;\n    }\n    super.disconnectedCallback();\n  }\n\n  protected attachResizeObserver() {\n    if (window.ResizeObserver) {\n      this.resizeObserver = new ResizeObserver((entries) => {\n        if (!this.indeterminate) {\n          return;\n        }\n\n        for (const entry of entries) {\n          if (entry.contentRect) {\n            const width = entry.contentRect.width;\n            this.calculateAndSetAnimationDimensions(width);\n          }\n        }\n      });\n      this.resizeObserver.observe(this.rootEl);\n      return;\n    }\n\n    this.resizeObserver = null;\n  }\n\n  protected calculateAndSetAnimationDimensions(width: number) {\n    const primaryHalf = width * 0.8367142;\n    const primaryFull = width * 2.00611057;\n    const secondaryQuarter = width * 0.37651913;\n    const secondaryHalf = width * 0.84386165;\n    const secondaryFull = width * 1.60277782;\n\n    this.stylePrimaryHalf = `${primaryHalf}px`;\n    this.stylePrimaryFull = `${primaryFull}px`;\n    this.styleSecondaryQuarter = `${secondaryQuarter}px`;\n    this.styleSecondaryHalf = `${secondaryHalf}px`;\n    this.styleSecondaryFull = `${secondaryFull}px`;\n\n    // need to restart animation for custom props to apply to keyframes\n    this.restartAnimation();\n  }\n\n  protected async restartAnimation() {\n    this.animationReady = false;\n    await this.updateComplete;\n    await new Promise(requestAnimationFrame);\n    this.animationReady = true;\n    await this.updateComplete;\n  }\n\n  open() {\n    this.closed = false;\n  }\n\n  close() {\n    this.closed = true;\n  }\n}\n"]}