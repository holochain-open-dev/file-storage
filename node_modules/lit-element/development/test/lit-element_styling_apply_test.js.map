{"version":3,"file":"lit-element_styling_apply_test.js","sourceRoot":"","sources":["../../src/test/lit-element_styling_apply_test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nimport '@webcomponents/shadycss/apply-shim.min.js';\nimport '../polyfill-support.js';\n\nimport {html as htmlWithStyles, LitElement, css} from '../lit-element.js';\n\nimport {\n  canTestLitElement,\n  generateElementName,\n  getComputedStyleValue,\n  nextFrame,\n} from './test-helpers.js';\nimport {assert} from '@esm-bundle/chai';\n\n(canTestLitElement ? suite : suite.skip)('Styling @apply', () => {\n  let container: HTMLElement;\n\n  setup(() => {\n    container = document.createElement('div');\n    document.body.appendChild(container);\n  });\n\n  teardown(() => {\n    if (container && container.parentNode) {\n      container.parentNode.removeChild(container);\n    }\n  });\n\n  test('@apply renders in nested elements', async () => {\n    customElements.define(\n      'x-inner2',\n      class extends LitElement {\n        render() {\n          return htmlWithStyles`\n        <style>\n          div {\n            @apply --bag;\n          }\n        </style>\n        <div>Testing...</div>`;\n        }\n      }\n    );\n    const name = generateElementName();\n    class E extends LitElement {\n      inner: LitElement | null = null;\n      render() {\n        return htmlWithStyles`\n        <style>\n          x-inner2 {\n            --bag: {\n              border: 10px solid red;\n            }\n          }\n        </style>\n        <x-inner2></x-inner2>`;\n      }\n\n      firstUpdated() {\n        this.inner = this.shadowRoot!.querySelector('x-inner2') as LitElement;\n      }\n    }\n    customElements.define(name, E);\n    const testInstance = async () => {\n      const el = document.createElement(name) as E;\n      container.appendChild(el);\n      // Workaround for Safari 9 Promise timing bugs.\n      (await el.updateComplete) && (await el.inner!.updateComplete);\n      await nextFrame();\n      const div = el\n        .shadowRoot!.querySelector('x-inner2')!\n        .shadowRoot!.querySelector('div');\n      assert.equal(\n        getComputedStyleValue(div!, 'border-top-width').trim(),\n        '10px'\n      );\n    };\n    await testInstance();\n    await testInstance();\n    await testInstance();\n  });\n\n  test('part values correct when @apply is used in multiple instances', async () => {\n    customElements.define(\n      'x-inner3',\n      class extends LitElement {\n        render() {\n          return htmlWithStyles`\n        <style>\n          div {\n            @apply --bag;\n          }\n        </style>\n        <div>Testing...</div>`;\n        }\n      }\n    );\n    const name = generateElementName();\n    class E extends LitElement {\n      inner: LitElement | null = null;\n      div!: HTMLDivElement;\n\n      render() {\n        return htmlWithStyles`\n        <style>\n          div {\n            border: 4px solid blue;\n          }\n          x-inner3 {\n            --bag: {\n              border: 10px solid red;\n            }\n          }\n        </style>\n        Outer Element\n        <div ?some-attr=\"${true}\">${'Button Text'}</div>\n        <x-inner3></x-inner3>`;\n      }\n\n      firstUpdated() {\n        this.inner = this.shadowRoot!.querySelector('x-inner3') as LitElement;\n        this.div = this.shadowRoot!.querySelector('div') as HTMLDivElement;\n      }\n    }\n    customElements.define(name, E);\n\n    const testInstance = async () => {\n      const el = document.createElement(name) as E;\n      container.appendChild(el);\n\n      // Workaround for Safari 9 Promise timing bugs.\n      (await el.updateComplete) && (await el.inner!.updateComplete);\n      await nextFrame();\n      await new Promise((r) => setTimeout(r, 100));\n      const div = el\n        .shadowRoot!.querySelector('x-inner3')!\n        .shadowRoot!.querySelector('div');\n      assert.equal(\n        getComputedStyleValue(div!, 'border-top-width').trim(),\n        '10px'\n      );\n      assert.ok(el.div.hasAttribute('some-attr'));\n      assert.equal(el.div.textContent, 'Button Text');\n    };\n    await testInstance();\n    await testInstance();\n    await testInstance();\n  });\n\n  test('@apply renders in nested elements when sub-element renders separately first', async () => {\n    class I extends LitElement {\n      render() {\n        return htmlWithStyles`\n        <style>\n          :host {\n            display: block;\n            width: 100px;\n            height: 100px;\n            border: 2px solid black;\n            margin-top: 10px;\n            @apply --bag;\n          }\n        </style>Hi`;\n      }\n    }\n    customElements.define('x-applied', I);\n\n    const name = generateElementName();\n    class E extends LitElement {\n      applied: HTMLElement | undefined;\n\n      render() {\n        return htmlWithStyles`\n        <style>\n          :host {\n            --bag: {\n              border: 10px solid black;\n              margin-top: 2px;\n            }\n          }\n        </style>\n        <x-applied></x-applied>`;\n      }\n\n      firstUpdated() {\n        this.applied = this.shadowRoot!.querySelector(\n          'x-applied'\n        ) as LitElement;\n      }\n    }\n    customElements.define(name, E);\n\n    const firstApplied = document.createElement('x-applied') as I;\n    container.appendChild(firstApplied);\n    const el = document.createElement(name) as E;\n    container.appendChild(el);\n\n    // Workaround for Safari 9 Promise timing bugs.\n    (await firstApplied.updateComplete) &&\n      el.updateComplete &&\n      (await (el.applied as I).updateComplete);\n\n    await nextFrame();\n    assert.equal(\n      getComputedStyleValue(firstApplied, 'border-top-width').trim(),\n      '2px'\n    );\n    assert.equal(\n      getComputedStyleValue(firstApplied, 'margin-top').trim(),\n      '10px'\n    );\n    assert.equal(\n      getComputedStyleValue(el.applied!, 'border-top-width').trim(),\n      '10px'\n    );\n    assert.equal(\n      getComputedStyleValue(el.applied!, 'margin-top').trim(),\n      '2px'\n    );\n  });\n\n  test('content shadowRoot is styled via static get styles in multiple instances', async () => {\n    const name = generateElementName();\n    customElements.define(\n      name,\n      class extends LitElement {\n        static get styles() {\n          return [\n            css`\n              div {\n                border: 2px solid blue;\n              }\n            `,\n            css`\n              span {\n                display: block;\n                border: 3px solid blue;\n              }\n            `,\n          ];\n        }\n\n        render() {\n          return htmlWithStyles`\n        <div>Testing1</div>\n        <span>Testing2</span>`;\n        }\n      }\n    );\n    const testInstance = async () => {\n      const el = document.createElement(name);\n      container.appendChild(el);\n      await (el as LitElement).updateComplete;\n      const div = el.shadowRoot!.querySelector('div');\n      assert.equal(\n        getComputedStyleValue(div!, 'border-top-width').trim(),\n        '2px'\n      );\n      const span = el.shadowRoot!.querySelector('span');\n      assert.equal(\n        getComputedStyleValue(span!, 'border-top-width').trim(),\n        '3px'\n      );\n    };\n    // test multiple instances\n    await testInstance();\n    await testInstance();\n    await testInstance();\n  });\n});\n"]}