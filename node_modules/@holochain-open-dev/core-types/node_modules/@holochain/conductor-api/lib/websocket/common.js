"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.promiseTimeout = exports.catchError = exports.DEFAULT_TIMEOUT = void 0;
const ERROR_TYPE = 'error';
exports.DEFAULT_TIMEOUT = 15000;
exports.catchError = (res) => {
    return res.type === ERROR_TYPE
        ? Promise.reject(res)
        : Promise.resolve(res);
};
exports.promiseTimeout = (promise, tag, ms) => {
    let id;
    let timeout = new Promise((resolve, reject) => {
        id = setTimeout(() => {
            clearTimeout(id);
            reject(new Error(`Timed out in ${ms}ms: ${tag}`));
        }, ms);
    });
    return new Promise((res, rej) => {
        Promise.race([
            promise,
            timeout
        ]).then((a) => {
            clearTimeout(id);
            return res(a);
        })
            .catch(e => {
            return rej(e);
        });
    });
};
//# sourceMappingURL=common.js.map